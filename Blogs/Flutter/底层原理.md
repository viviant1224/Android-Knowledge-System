# 底层原理

## 框架结构
![image](https://github.com/viviant1224/Android-Knowledge-System/blob/main/images/flutter/flutter2.png)   
从该架构图可知，Flutter框架可分为***Framework***层和***Engine***层；  
***框架（Framework）部分是用Dart语言写***  

* Flutter Framework: 整个框架层都是用Dart语言实现，该层提供一套基础库， 用于处理动画、绘图和手势等。并且基于绘图封装了一套 UI组件库，并且细分为两种风格的组件 。  
* Foundation、Animation、Painting、Gestures 为 Dart 实现的 UI 层，提供动画、手势及绘制。  
* Rendering 渲染层，依赖 UI 层，在运行时 Rendering 层会构建一个 Widget 树，当有变化时，会根据一定的算法计算出有变化的部分，然后更新 Widget 树。  
* Widgets 层是 Flutter 提供的的一套基础组件库，在基础组件库之上，Flutter 还提供了 Material 和 Cupertino 两种视觉风格的组件库。  
* Materail : Android风格的Widget  
* Cupertino: IOS风格的Widget  
***Flutter Engine 引擎（Engine）部分是用C++实现的。引擎为框架提供支撑，也是连接框架和系统（Android/iOS）的桥梁***  
* Skia 是一个开源的二维图形库，提供各种常用的 API，并可在多种软硬件平台上运行。谷歌 Chrome 浏览器、Chrome OS、安卓、火狐浏览器、火狐操作系统以及其它许多产品都使用它作为图形引擎。
Skia 由谷歌出资管理，任何人都可基于 BSD 免费软件许可证使用 Skia。Skia 开发团队致力于开发其核心部分， 并广泛采纳各方对于 Skia 的开源贡献。
因为没有使用原生的 UI 和绘制框架，所以才保证了 Flutter 的高性能体验。  
* Flutter Engine: 这是一个纯 C++实现的 SDK，其中囊括了 Skia引擎、Dart运行时、文字排版引擎等。不过说白了，它就是 Dart的一个运行时，它可以以 JIT、JIT Snapshot 或者 AOT的模式运行 Dart代码。在代码调用 dart:ui库时，提供 dart:ui库中 Native Binding 实现。 不过别忘了，这个运行时还控制着 VSync信号的传递、GPU数据的填充等，并且还负责把客户端的事件传递到运行时中的代码。

## 线程模型

## 绘制原理
![image](https://github.com/viviant1224/Android-Knowledge-System/blob/main/images/flutter/flutter1.png) 

## 通信原理

## 图形渲染
